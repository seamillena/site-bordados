<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <link href="https://fonts.googleapis.com/css2?family=Bree+Serif&family=Montserrat:wght@700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='estilo.css') }}">
    <title>Início - O Astronauta Bordados</title>
</head>

<body>
        <nav>
        <div class="botao-perfil">
            <div class="foto-perfil">
                {% if usuario %}
                    <a href="{{ url_for('perfiladm') }}">
                        <img src="{{ url_for('static', filename='imagens/' ~ (foto or 'user.png')) }}">
                    </a>
                {% else %}
                    <img src="{{ url_for('static', filename='imagens/user.png') }}">
                {% endif %}
            </div>
        
            {%if nome and sobrenome %}
                <a href="{{url_for('perfiladm')}}">{{nome}} {{sobrenome}}</a>
            {% else %}
                <a href="{{url_for('perfil')}}">Usuário</a>
            {% endif %}
          </div>
    
    
        <a href="/inicioadm">Início</a> |
        <a href="/catalogoadm">Catálogo</a> |
        <a href="/muraladm">Mural</a> |
        <a href="/configuracoes">Configurações</a> |
        <a href="/pedidos">Pedidos</a> |
        <a href="/logout" onclick="return confirm('Tem certeza que deseja sair?')">Logout</a>
    </nav>

<header class="logo-header">
    <img src="{{ url_for('static', filename='imagens/astronauta.png') }}" alt="Astronauta bordando">
    <div class="texto-logo">
        <h1>O Astronauta</h1>
        <h2>BORDADOS | ADMINISTRADOR</h2>
    </div>
</header>

<div class="botao-centro">
    <a href="{{ url_for('catalogoadm', tema=tema if tema and tema|lower != 'todos' else None) }}" class="botao">Voltar ao Catálogo</a>
</div>


<form method="POST" enctype="multipart/form-data">
    <div class="editar-imagem">
        <p for="imagem">Alterar imagem principal:</p>
        {% if bordado and bordado['imagem'] %}
            <img src="{{ url_for('static', filename='imagens/' + bordado['imagem']) }}" alt="Imagem principal" width="150">
        {% else %}
            <img src="{{ url_for('static', filename='imagens/none_foto.jpg') }}" width="100" alt="Sem imagem enviada">
        {% endif %}
    <div class="editar-bordado">
        <input type="file" name="imagem" accept="image/*">
        <div class="editar-campos">

            <p for="nome">Nome:</p>
            <input type="text" name="nome" value="{{ bordado['nome'] }}" required>

            <p for="descricao">Detalhes:</p>
            <textarea name="descricao" required>{{ bordado['descricao'] }}</textarea>

            <p for="preco">Preço (R$):</p>
            <input type="number" step="0.01" name="preco" value="{{ bordado['preco'] }}" required>
        
            <p for="temas">Temas:</p>
            <textarea name="temas">{{ bordado['temas'] }}</textarea>
        </div>  
        <p for="imagem_bordado_extra">Adicionar imagens extras:</p>
        <input type="file" name="imagem_bordado_extra" multiple accept="image/*">
    </div>
        
        <button type="submit" class="botao">Salvar</button>
  
</form>

<!-- FORMULÁRIOS SEPARADOS PARA EXCLUIR IMAGENS EXTRAS -->
<div class="imagens-extras">
    {% if bordado['imagens_extras'] %}
        {% set imagens_extras = bordado['imagens_extras'].split(',') %}
        {% for imagem_extra in imagens_extras %}
            <div class="imagens-extras-container">
                <img src="{{ url_for('static', filename='imagens/' + imagem_extra.strip()) }}" alt="Imagem extra" width="150">
                
                <form method="POST" action="{{ url_for('excluir_imagem_extra') }}">
                    <input type="hidden" name="id" value="{{ bordado['id'] }}">
                    <input type="hidden" name="imagem" value="{{ imagem_extra.strip() }}">
                    <button type="submit" class="btn btn-danger" onclick="return confirm('Tem certeza que deseja excluir este bordado?')">Excluir</button>
                </form>
            </div>
        {% endfor %}
    {% else %}
        <img src="{{ url_for('static', filename='imagens/none_foto.jpg') }}" width="100" alt="Sem imagem enviada">
    {% endif %}
</div>

<script>
    // Salva a posição do scroll antes de sair da página
    window.onbeforeunload = function() {
        sessionStorage.setItem('scrollPosition', window.scrollY);
    };

    // Restaura a posição do scroll quando a página é recarregada
    window.onload = function() {
        var scrollPosition = sessionStorage.getItem('scrollPosition');
        if (scrollPosition) {
            window.scrollTo(0, scrollPosition);
        }
    };
</script>

<footer class ="rodape">
    <p>&copy; 2025 O Astronauta Bordados.</p>
    {%for contato in contatos %}
    <p>{{ contato['numero'] }} | {{ contato['email'] }} | {{ contato['insta'] }}</p>
    {% endfor %}
</footer>
</body>
</html>
